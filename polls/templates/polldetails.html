{% extends 'basic.html' %}

{% block title %}Public Poll - {{poll.title}}{% endblock %}

{% block publicPollsActive %}active{% endblock %}

{% block body %}
<div class="container my-3 main">
    {% if user.is_authenticated %}
    <h3 class="text-center">Poll name: {{poll.title}}</h3>
    <hr>
    <h5>About this poll:</h5>
    <div class="col-12">
        {% if request.user == poll.owner %}
        <p>This poll is created by You <a href="/profile"><span class="badge bg-info">{{poll.owner}}</span></a> and is
            ending on {{poll.endtime}}</p>
        {% else %}
        <p>This poll is created by <a href="/userprofile/{{poll.owner}}"><span
                    class="badge bg-secondary">{{poll.owner}}</span></a> and is ending on {{poll.endtime}}</p>
        {% endif %}
        <p>Description: {{poll.desc}}</p>
        {% if request.user == poll.owner %}
        <form action="/polls/polldetails/{{poll.id}}/deletepublicpoll" method="POST" class="row g-3"> {% csrf_token %}
            <div class="col-12">
                <button type="submit" name="delete" id="delete" class="btn btn-danger" value="delete">Delete poll</button>
            </div>
        </form>
        {% endif %}
    </div>
    <hr>
    {% if hasVoted %}
    <b>You have already voted!</b>
    <p>The choices were:</p>
    <ul class="list-group">
        <li class="list-group-item">1. {{poll.choice1}}</li>
        <li class="list-group-item">2. {{poll.choice2}}</li>
    </ul>
    <a class="btn btn-primary mt-3" href="/polls/polldetails/{{poll.id}}/results" role="button">See Results</a>
    {% else %}
    <b>Please select your choice:</b>
    <form action="/polls/polldetails/{{poll.id}}/vote/" method="POST"> {% csrf_token %}
        <div class="form-check my-2">
            <input class="form-check-input" type="radio" name="choice" id="choice1" value="{{poll.choice1}}" required>
            <label class="form-check-label" for="choice2">{{poll.choice1}}</label>
        </div>
        <div class="form-check">
            <input class="form-check-input" type="radio" name="choice" id="choice2" value="{{poll.choice2}}" required>
            <label class="form-check-label" for="choice2">{{poll.choice2}}</label>
        </div>
        <input type="submit" value="Vote" class="btn btn-primary mt-3">
        <a class="btn btn-warning mt-3" href="/polls/polldetails/{{poll.id}}" role="button">Uncheck</a>
    </form>
    {% endif %}
    {% else %}
    <p>Please login to access this area :)</p>
    {% endif %}
</div>
{% endblock %}